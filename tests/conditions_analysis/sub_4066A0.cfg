
=== 0 0 7 ===
sub_4066A0 proc near
var_18= dword ptr -18h
push esi
mov esi, eax
push ebx
sub esp, 14
mov edx, ds:dword_40AD20


=== 1 7 9 ===
cmp edx, 2
jz short loc_4066F7


=== 2 9 11 ===
test edx, edx
jnz short loc_40671E


=== 3 11 13 ===
mov dl, 1
lock xchg edx, ds:dword_40AD20


=== 4 13 15 ===
test edx, edx
jnz short loc_406713


=== 5 15 25 ===
mov ebx, ds:InitializeCriticalSection
mov [esp+18h+var_18], offset unk_40AD40
call eb
sub esp, 4
mov [esp+18h+var_18], offset unk_40AD58
call eb
sub esp, 4
mov [esp+18h+var_18], offset dword_406790
call sub_401750
mov ds:dword_40AD20, 2


=== 6 25 35 ===
loc_4066F7:
lea eax, [esi+esi*2]
lea eax, ds:40AD40h[eax*8]
mov [esp+18h+var_18], eax
call ds:EnterCriticalSection
sub esp, 4
add esp, 14h
pop ebx
pop esi
retn 


=== 7 35 38 ===
loc_406713:
cmp edx, 2
jz short loc_406752


=== 8 38 39 ===
mov edx, ds:dword_40AD20


=== 9 39 42 ===
loc_40671E:
cmp edx, 1
jnz short loc_406747


=== 10 42 44 ===
mov ebx, ds:Sleep
lea esi, [esi+0]


=== 11 44 49 ===
loc_406730:
mov [esp+18h+var_18], 1
call eb
mov edx, ds:dword_40AD20
sub esp, 4


=== 12 49 51 ===
cmp edx, 1
jz short loc_406730


=== 13 51 54 ===
loc_406747:
cmp edx, 2
jz short loc_4066F7


=== 14 54 58 ===
add esp, 14h
pop ebx
pop esi
retn 


=== 15 58 61 ===
loc_406752:
mov ds:dword_40AD20, 2
jmp short loc_4066F7

0-1
1-6
1-2
2-9
2-3
3-4
4-7
4-5
5-6
7-15
7-8
8-9
9-13
9-10
10-11
11-12
12-11
12-13
13-6
13-14
15-6
==================
Analyzer is reducing graph ...
Postorder of dfs-tree: [15, 8, 7, 5, 4, 3, 6, 14, 13, 12, 11, 10, 9, 2, 1, 0]
==================
analyzing node 15 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [15]
found nothing, block is singular.
==================
analyzing node 8 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [8]
found nothing, block is singular.
==================
analyzing node 7 ...
target of backedge  ... False
branching ... True
couldn't find simple structure.
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
==================
analyzing node 5 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [5]
found nothing, block is singular.
==================
analyzing node 4 ...
target of backedge  ... False
branching ... True
couldn't find simple structure.
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
==================
analyzing node 3 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [3, 4]
appendable to 4 ... False
reduction successful.
current nodeset: | 0 | 1 | 2 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 | 14 | 15 | 17 | 
current edgeset: | 9-10 | 1-2 | 0-1 | 12-11 | 11-12 | 7-15 | 2-9 | 12-13 | 1-6 | 17-7 | 17-5 | 2-17 | 8-9 | 13-6 | 13-14 | 15-6 | 10-11 | 7-8 | 9-13 | 5-6 | 
applying recursive analysis ...
==================
analyzing node 17 ...
target of backedge  ... False
branching ... True
couldn't find simple structure.
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
==================
analyzing node 6 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [6]
found nothing, block is singular.
==================
analyzing node 14 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [14]
found nothing, block is singular.
==================
analyzing node 13 ...
target of backedge  ... False
branching ... True
couldn't find simple structure.
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
==================
analyzing node 12 ...
target of backedge  ... False
branching ... True
couldn't find simple structure.
found knot-node: 13
==================
analyzing node 11 ...
target of backedge  ... 12
branching ... False
loop... False
found simple structure.
block: [11, 12]
appendable to 12 ... False
correcting to do-loop.
reduction successful.
current nodeset: | 0 | 1 | 2 | 5 | 6 | 7 | 8 | 9 | 10 | 13 | 14 | 15 | 17 | 18 | 
current edgeset: | 1-2 | 0-1 | 7-8 | 5-6 | 18-13 | 7-15 | 2-9 | 10-18 | 1-6 | 17-7 | 17-5 | 2-17 | 8-9 | 13-14 | 15-6 | 9-10 | 9-13 | 13-6 | 
applying recursive analysis ...
==================
analyzing node 18 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [18]
found nothing, block is singular.
==================
analyzing node 10 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [10, 18]
appendable to 18 ... False
reduction successful.
current nodeset: | 0 | 1 | 2 | 5 | 6 | 7 | 8 | 9 | 13 | 14 | 15 | 17 | 19 | 
current edgeset: | 2-9 | 5-6 | 0-1 | 7-15 | 1-2 | 2-17 | 19-13 | 1-6 | 17-7 | 17-5 | 7-8 | 9-19 | 8-9 | 15-6 | 13-14 | 9-13 | 13-6 | 
applying recursive analysis ...
==================
analyzing node 19 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [19]
found nothing, block is singular.
==================
analyzing node 9 ...
target of backedge  ... False
branching ... True
found simple structure.
if-then: [9, 19]
reduction successful.
current nodeset: | 0 | 1 | 2 | 5 | 6 | 7 | 8 | 13 | 14 | 15 | 17 | 20 | 
current edgeset: | 5-6 | 0-1 | 7-8 | 7-15 | 1-2 | 17-5 | 1-6 | 17-7 | 20-13 | 2-17 | 13-6 | 13-14 | 8-20 | 15-6 | 2-20 | 
applying recursive analysis ...
==================
analyzing node 20 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [20, 13]
appendable to 13 ... False
reduction successful.
current nodeset: | 0 | 1 | 2 | 5 | 6 | 7 | 8 | 14 | 15 | 17 | 21 | 
current edgeset: | 8-21 | 5-6 | 0-1 | 7-15 | 1-2 | 2-17 | 1-6 | 17-7 | 17-5 | 7-8 | 21-6 | 15-6 | 2-21 | 21-14 | 
applying recursive analysis ...
==================
analyzing node 21 ...
target of backedge  ... False
branching ... True
couldn't find simple structure.
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
==================
analyzing node 2 ...
target of backedge  ... False
branching ... True
couldn't find simple structure.
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
==================
analyzing node 1 ...
target of backedge  ... False
branching ... True
couldn't find simple structure.
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
==================
analyzing node 0 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [0, 1]
appendable to 1 ... False
reduction successful.
current nodeset: | 2 | 5 | 6 | 7 | 8 | 14 | 15 | 17 | 21 | 22 | 
current edgeset: | 8-21 | 5-6 | 7-15 | 7-8 | 15-6 | 17-7 | 22-6 | 17-5 | 2-17 | 22-2 | 21-6 | 2-21 | 21-14 | 
applying recursive analysis ...
==================
analyzing node 22 ...
target of backedge  ... False
branching ... True
couldn't find simple structure.
