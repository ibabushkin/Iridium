
=== 0 0 7 ===
sub_4028D0 proc near
var_28= dword ptr -28h
var_24= dword ptr -24h
var_C= dword ptr -0Ch
push ebx
sub esp, 28h
mov ecx, [edx+4]


=== 1 7 9 ===
test ch, 40h
jnz short loc_4028E4


=== 2 9 12 ===
mov ebx, [edx+20h]
cmp [edx+24h], ebx
jle short loc_4028F4


=== 3 12 15 ===
loc_4028E4:
and ch, 20h
jnz short loc_402900


=== 4 15 19 ===
mov ebx, [edx]
mov ecx, [edx+20h]
mov [ebx+ecx], al
mov ebx, [edx+20h]


=== 5 19 26 ===
loc_4028F4:
add ebx, 1
mov [edx+20h], ebx
add esp, 28h
pop ebx
retn 
align 10h


=== 6 26 40 ===
loc_402900:
mov ecx, [edx]
mov [esp+28h+var_28], eax
mov [esp+28h+var_C], edx
mov [esp+28h+var_24], ecx
call fputc
mov edx, [esp+28h+var_C]
mov ebx, [edx+20h]
add ebx, 1
mov [edx+20h], ebx
add esp, 28h
pop ebx
retn 
sub_4028D0 endp

0-1
1-3
1-2
2-5
2-3
3-6
3-4
4-5
5-6
==================
Analyzer is reducing graph ...
Postorder of dfs-tree: [6, 5, 4, 3, 2, 1, 0]
==================
analyzing node 6 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [6]
found nothing, block is singular.
==================
analyzing node 5 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [5]
found nothing, block is singular.
==================
analyzing node 4 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [4]
found nothing, block is singular.
==================
analyzing node 3 ...
target of backedge  ... False
branching ... True
couldn't find simple structure.
found knot-node: 6
block: [6]
found nothing, block is singular.
==================
analyzing node 2 ...
target of backedge  ... False
branching ... True
couldn't find simple structure.
found knot-node: 6
block: [6]
found nothing, block is singular.
==================
analyzing node 1 ...
target of backedge  ... False
branching ... True
couldn't find simple structure.
found knot-node: 6
reducing condition: [1, 2, 3]
replaced edges: 2-5 3-6 3-4
==================
analyzing node 0 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [0, 7]
appendable to 7 ... False
reduction successful.
current nodeset: | 8 | 4 | 5 | 6 | 
current edgeset: | 8-4 | 8-5 | 8-6 | 5-6 | 4-5 | 
applying recursive analysis ...
==================
analyzing node 8 ...
target of backedge  ... False
branching ... False
==================RESULTS==================
Graph starting at node 8
id: 8 type: block starts at 0:
    |-- nodes:
    |   id: 0 type: low-level
    |   +----------------------+
    |   |sub_4028D0 proc near  |
    |   |var_28= dword ptr -28h|
    |   |var_24= dword ptr -24h|
    |   |var_C= dword ptr -0Ch |
    |   |push ebx              |
    |   |sub esp, 28h          |
    |   |mov ecx, [edx+4]      |
    |   +----------------------+
    |   
    |   id: 7 type: condition starts at 1:
    |       |-- nodes:
    |       |   id: 1 type: low-level
    |       |   +--------------------+
    |       |   |test ch, 40h        |
    |       |   |jnz short loc_4028E4|
    |       |   +--------------------+
    |       |   
    |       |   id: 2 type: low-level
    |       |   +--------------------+
    |       |   |mov ebx, [edx+20h]  |
    |       |   |cmp [edx+24h], ebx  |
    |       |   |jle short loc_4028F4|
    |       |   +--------------------+
    |       |   
    |       |   id: 3 type: low-level
    |       |   +--------------------+
    |       |   |loc_4028E4:         |
    |       |   |and ch, 20h         |
    |       |   |jnz short loc_402900|
    |       |   +--------------------+
    |       |   
    |       |-- edges:
    |       |       1-3
    |       |       1-2
    |       |       2-3
    |       |   
    |       |-- outer edges:
    |       |       2-5
    |       |       3-6
    |       |       3-4
    |       
    |-- edges:
    |       0-7
    
id: 4 type: low-level
+------------------+
|mov ebx, [edx]    |
|mov ecx, [edx+20h]|
|mov [ebx+ecx], al |
|mov ebx, [edx+20h]|
+------------------+

id: 5 type: low-level
+------------------+
|loc_4028F4:       |
|add ebx, 1        |
|mov [edx+20h], ebx|
|add esp, 28h      |
|pop ebx           |
|retn              |
|align 10h         |
+------------------+

id: 6 type: low-level
+-------------------------+
|loc_402900:              |
|mov ecx, [edx]           |
|mov [esp+28h+var_28], eax|
|mov [esp+28h+var_C], edx |
|mov [esp+28h+var_24], ecx|
|call fputc               |
|mov edx, [esp+28h+var_C] |
|mov ebx, [edx+20h]       |
|add ebx, 1               |
|mov [edx+20h], ebx       |
|add esp, 28h             |
|pop ebx                  |
|retn                     |
|sub_4028D0 endp          |
+-------------------------+

