
=== 0 0 19 ===
sub_405F50 proc near
var_34= dword ptr -34h
var_30= dword ptr -30h
var_2C= dword ptr -2Ch
var_28= dword ptr -28h
var_24= dword ptr -24h
var_20= dword ptr -20h
var_8= dword ptr -8
arg_0= dword ptr  0Ch
arg_4= dword ptr  10h
arg_8= dword ptr  14h
arg_C= dword ptr  18h
arg_10= dword ptr  1Ch
arg_14= dword ptr  20h
push esi
push ebx
sub esp, 34
mov ebx, [esp+34h+arg_4]
mov esi, [esp+34h+arg_C]


=== 1 19 21 ===
test ebx, ebx
jz loc_4060C5


=== 2 21 24 ===
mov edx, [esp+34h+arg_8]
test edx, edx
jz loc_4060D0


=== 3 24 28 ===
mov eax, [esi]
mov dword ptr [esi], 0
mov [esp+34h+var_8], eax
movzx eax, byte ptr [ebx]


=== 4 28 30 ===
test al, al
jz loc_406020


=== 5 30 32 ===
cmp [esp+34h+arg_14], 1
jbe short loc_406000


=== 6 32 34 ===
cmp byte ptr [esp+34h+var_8], 0
jnz loc_406031


=== 7 34 39 ===
mov edx, [esp+34h+arg_10]
mov [esp+34h+var_30], eax
mov [esp+34h+var_34], edx
call ds:IsDBCSLeadByteEx
sub esp, 8


=== 8 39 41 ===
test eax, eax
jz short loc_406000


=== 9 41 43 ===
cmp [esp+34h+arg_8], 1
jbe loc_4060DA


=== 10 43 53 ===
mov eax, [esp+34h+arg_0]
mov edx, [esp+34h+arg_10]
mov [esp+34h+var_20], 1
mov [esp+34h+var_28], 2
mov [esp+34h+var_24], eax
mov [esp+34h+var_2C], ebx
mov [esp+34h+var_30], 8
mov [esp+34h+var_34], edx
call ds:MultiByteToWideChar
sub esp, 18h


=== 11 53 55 ===
test eax, eax
jz short loc_406071


=== 12 55 61 ===
loc_405FF5:
add esp, 34h
mov eax, 2
pop ebx
pop esi
retn 


=== 13 61 63 ===
loc_406000:
mov eax, [esp+34h+arg_10]


=== 14 63 65 ===
test eax, eax
jnz short loc_406083


=== 15 65 74 ===
movzx eax, byte ptr [ebx]
mov edx, [esp+34h+arg_0]
mov [edx], ax
add esp, 34h
mov eax, 1
pop ebx
pop esi
retn 
align 10h


=== 16 74 78 ===
loc_406020:
mov eax, [esp+34h+arg_0]
mov word ptr [eax], 0
xor eax, eax


=== 17 78 83 ===
loc_40602B:
add esp, 34h
pop ebx
pop esi
retn 


=== 18 83 96 ===
loc_406031:
mov byte ptr [esp+34h+var_8+1], al
lea eax, [esp+34h+var_8]
mov edx, [esp+34h+arg_0]
mov [esp+34h+var_2C], eax
mov eax, [esp+34h+arg_10]
mov [esp+34h+var_20], 1
mov [esp+34h+var_28], 2
mov [esp+34h+var_24], edx
mov [esp+34h+var_30], 8
mov [esp+34h+var_34], eax
call ds:MultiByteToWideChar
sub esp, 18


=== 19 96 98 ===
test eax, eax
jnz short loc_405FF5


=== 20 98 103 ===
loc_406071:
call _errno
mov dword ptr [eax], 2Ah
mov eax, 0FFFFFFFFh
jmp short loc_40602B


=== 21 103 114 ===
loc_406083:
mov eax, [esp+34h+arg_0]
mov edx, [esp+34h+arg_10]
mov [esp+34h+var_20], 1
mov [esp+34h+var_28], 1
mov [esp+34h+var_24], eax
mov [esp+34h+var_2C], ebx
mov [esp+34h+var_30], 8
mov [esp+34h+var_34], edx
call ds:MultiByteToWideChar
sub esp, 18h


=== 22 114 116 ===
test eax, eax
jz short loc_406071


=== 23 116 118 ===
mov eax, 1
jmp loc_40602B


=== 24 118 125 ===
loc_4060C5:
add esp, 34h
xor eax, eax
pop ebx
pop esi
retn 
align 10h


=== 25 125 128 ===
loc_4060D0:
mov eax, 0FFFFFFFEh
jmp loc_40602B


=== 26 128 133 ===
loc_4060DA:
movzx eax, byte ptr [ebx]
mov [esi], al
mov eax, 0FFFFFFFEh
jmp loc_40602B

0-1
1-24
1-2
2-25
2-3
3-4
4-16
4-5
5-13
5-6
6-18
6-7
7-8
8-13
8-9
9-26
9-10
10-11
11-20
11-12
13-14
14-21
14-15
15-16
16-17
18-19
19-12
19-20
20-17
21-22
22-20
22-23
23-17
24-25
25-17
26-17
==================
Analyzer is reducing graph ...
Postorder of dfs-tree: [11, 10, 26, 9, 8, 7, 12, 19, 18, 6, 15, 23, 20, 22, 21, 14, 13, 5, 16, 4, 3, 2, 17, 25, 24, 1, 0]
==================
analyzing node 11 ...
target of backedge  ... False
branching ... True
couldn't find simple structure.
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
==================
analyzing node 10 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [10, 11]
appendable to 11 ... False
reduction successful.
current nodeset: | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 12 | 13 | 14 | 15 | 16 | 17 | 18 | 19 | 20 | 21 | 22 | 23 | 24 | 25 | 26 | 28 | 
current edgeset: | 21-22 | 18-19 | 9-26 | 4-16 | 16-17 | 14-21 | 9-28 | 25-17 | 6-18 | 13-14 | 15-16 | 2-25 | 28-12 | 2-3 | 5-13 | 0-1 | 24-25 | 1-2 | 8-13 | 5-6 | 23-17 | 6-7 | 14-15 | 22-23 | 28-20 | 7-8 | 4-5 | 22-20 | 1-24 | 3-4 | 19-12 | 26-17 | 8-9 | 20-17 | 19-20 | 
applying recursive analysis ...
==================
analyzing node 28 ...
target of backedge  ... False
branching ... True
couldn't find simple structure.
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
==================
analyzing node 26 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [26]
found nothing, block is singular.
==================
analyzing node 9 ...
target of backedge  ... False
branching ... True
couldn't find simple structure.
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
==================
analyzing node 8 ...
target of backedge  ... False
branching ... True
couldn't find simple structure.
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
==================
analyzing node 7 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [8, 7]
appendable to 8 ... False
reduction successful.
current nodeset: | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 9 | 12 | 13 | 14 | 15 | 16 | 17 | 18 | 19 | 20 | 21 | 22 | 23 | 24 | 25 | 26 | 28 | 29 | 
current edgeset: | 9-26 | 4-16 | 16-17 | 14-21 | 9-28 | 29-9 | 29-13 | 6-18 | 13-14 | 15-16 | 2-25 | 28-12 | 2-3 | 5-13 | 25-17 | 24-25 | 1-2 | 5-6 | 0-1 | 23-17 | 21-22 | 14-15 | 4-5 | 6-29 | 18-19 | 22-23 | 22-20 | 1-24 | 3-4 | 19-12 | 26-17 | 28-20 | 20-17 | 19-20 | 
applying recursive analysis ...
==================
analyzing node 29 ...
target of backedge  ... False
branching ... True
couldn't find simple structure.
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
==================
analyzing node 12 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [12]
found nothing, block is singular.
==================
analyzing node 19 ...
target of backedge  ... False
branching ... True
couldn't find simple structure.
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
==================
analyzing node 18 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [18, 19]
appendable to 19 ... False
reduction successful.
current nodeset: | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 9 | 12 | 13 | 14 | 15 | 16 | 17 | 20 | 21 | 22 | 23 | 24 | 25 | 26 | 28 | 29 | 30 | 
current edgeset: | 9-26 | 4-16 | 16-17 | 14-21 | 9-28 | 29-9 | 0-1 | 30-20 | 25-17 | 6-30 | 13-14 | 15-16 | 2-25 | 28-12 | 2-3 | 5-13 | 29-13 | 24-25 | 1-2 | 23-17 | 21-22 | 14-15 | 22-23 | 6-29 | 5-6 | 4-5 | 22-20 | 1-24 | 3-4 | 30-12 | 26-17 | 28-20 | 20-17 | 
applying recursive analysis ...
==================
analyzing node 30 ...
target of backedge  ... False
branching ... True
couldn't find simple structure.
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
==================
analyzing node 6 ...
target of backedge  ... False
branching ... True
couldn't find simple structure.
No reduction of condition possible, retrying...
No reduction of condition possible, retrying...
