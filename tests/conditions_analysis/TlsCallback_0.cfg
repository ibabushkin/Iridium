
=== 0 0 9 ===
TlsCallback_0 proc near
var_18= dword ptr -18h
var_14= dword ptr -14h
var_10= dword ptr -10h
arg_0= dword ptr  8
arg_4= dword ptr  0Ch
arg_8= dword ptr  10h
push ebx
sub esp, 18h


=== 1 9 12 ===
cmp dword_408014, 2
mov eax, [esp+18h+arg_4]
jz short loc_4015EB


=== 2 12 13 ===
mov dword_408014, 2


=== 3 13 16 ===
loc_4015EB:
cmp eax, 2
jz short loc_401601


=== 4 16 18 ===
cmp eax, 1
jz short loc_401630


=== 5 18 23 ===
loc_4015F5:
add esp, 18h
mov eax, 1
pop ebx
retn 0Ch


=== 6 23 25 ===
loc_401601:
mov ebx, offset unk_40C030


=== 7 25 27 ===
cmp ebx, offset unk_40C030
jz short loc_4015F5


=== 8 27 29 ===
db 66h
nop 


=== 9 29 31 ===
loc_401610:
mov eax, [ebx]


=== 10 31 33 ===
test eax, eax
jz short loc_401618


=== 11 33 34 ===
call eax


=== 12 34 36 ===
loc_401618:
add ebx, 4


=== 13 36 38 ===
cmp ebx, offset unk_40C030
jnz short loc_401610


=== 14 38 43 ===
add esp, 18h
mov eax, 1
pop ebx
retn 0Ch
align 10h


=== 15 43 51 ===
loc_401630:
mov eax, [esp+18h+arg_8]
mov [esp+18h+var_14], 1
mov [esp+18h+var_10], eax
mov eax, [esp+18h+arg_0]
mov [esp+18h+var_18], eax
call sub_402640
jmp short loc_4015F5

0-1
1-3
1-2
2-3
3-6
3-4
4-15
4-5
6-7
7-5
7-8
8-9
9-10
10-12
10-11
11-12
12-13
13-9
13-14
14-15
15-5
==================
Analyzer is reducing graph ...
Postorder of dfs-tree: [14, 13, 12, 11, 10, 9, 8, 7, 6, 15, 5, 4, 3, 2, 1, 0]
==================
analyzing node 14 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [14]
found nothing, block is singular.
==================
analyzing node 13 ...
target of backedge  ... False
branching ... True
couldn't find simple structure.
found knot-node: 14
block: [16]
found nothing, block is singular.
==================
analyzing node 12 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [12, 13]
appendable to 13 ... False
reduction successful.
current nodeset: | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 14 | 15 | 17 | 
current edgeset: | 2-3 | 11-17 | 1-2 | 0-1 | 17-14 | 3-6 | 1-3 | 3-4 | 15-5 | 7-5 | 7-8 | 8-9 | 4-15 | 10-17 | 6-7 | 14-15 | 10-11 | 9-10 | 17-9 | 4-5 | 
applying recursive analysis ...
==================
analyzing node 17 ...
target of backedge  ... False
branching ... True
couldn't find simple structure.
found knot-node: 14
==================
analyzing node 11 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [11]
found nothing, block is singular.
==================
analyzing node 10 ...
target of backedge  ... False
branching ... True
found simple structure.
if-then: [10, 11]
reduction successful.
current nodeset: | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 14 | 15 | 17 | 18 | 
current edgeset: | 2-3 | 3-4 | 0-1 | 17-14 | 3-6 | 1-3 | 1-2 | 15-5 | 18-17 | 7-5 | 4-5 | 7-8 | 8-9 | 4-15 | 6-7 | 14-15 | 17-9 | 9-18 | 
applying recursive analysis ...
==================
analyzing node 18 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [17, 18]
appendable to 17 ... True
appending to existing block ... done: 17
reduction successful.
current nodeset: | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 14 | 15 | 17 | 
current edgeset: | 2-3 | 1-2 | 0-1 | 17-14 | 3-6 | 1-3 | 3-4 | 15-5 | 7-5 | 7-8 | 8-9 | 4-15 | 6-7 | 9-17 | 14-15 | 17-9 | 4-5 | 
applying recursive analysis ...
==================
analyzing node 17 ...
target of backedge  ... False
branching ... True
couldn't find simple structure.
found knot-node: 14
block: [18]
found nothing, block is singular.
==================
analyzing node 9 ...
target of backedge  ... 17
branching ... False
loop... False
found simple structure.
block: [9, 17]
appendable to 17 ... True
appending to existing block ... done: 17
reduction successful.
current nodeset: | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 14 | 15 | 17 | 
current edgeset: | 2-3 | 3-4 | 17-17 | 0-1 | 17-14 | 3-6 | 1-3 | 1-2 | 15-5 | 7-5 | 7-8 | 8-17 | 6-7 | 14-15 | 4-15 | 4-5 | 
applying recursive analysis ...
==================
analyzing node 17 ...
target of backedge  ... 17
branching ... True
loop... False
found simple structure.
do-loop: 17
reduction successful.
current nodeset: | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 14 | 15 | 19 | 
current edgeset: | 2-3 | 1-2 | 0-1 | 8-19 | 3-6 | 1-3 | 3-4 | 15-5 | 7-5 | 7-8 | 19-14 | 6-7 | 14-15 | 4-15 | 4-5 | 
applying recursive analysis ...
==================
analyzing node 19 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [19, 14]
appendable to 14 ... False
reduction successful.
current nodeset: | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 15 | 20 | 
current edgeset: | 2-3 | 8-20 | 0-1 | 3-6 | 1-3 | 1-2 | 15-5 | 7-5 | 3-4 | 7-8 | 20-15 | 4-15 | 6-7 | 4-5 | 
applying recursive analysis ...
==================
analyzing node 20 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [20]
found nothing, block is singular.
==================
analyzing node 8 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [8, 20]
appendable to 20 ... True
appending to existing block ... done: 20
reduction successful.
current nodeset: | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 15 | 20 | 
current edgeset: | 2-3 | 3-4 | 0-1 | 3-6 | 1-3 | 1-2 | 15-5 | 7-5 | 20-15 | 4-15 | 6-7 | 7-20 | 4-5 | 
applying recursive analysis ...
==================
analyzing node 20 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [20]
found nothing, block is singular.
==================
analyzing node 7 ...
target of backedge  ... False
branching ... True
couldn't find simple structure.
found knot-node: 5
block: [20]
found nothing, block is singular.
==================
analyzing node 6 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [6, 7]
appendable to 7 ... False
reduction successful.
current nodeset: | 0 | 1 | 2 | 3 | 4 | 5 | 15 | 20 | 21 | 
current edgeset: | 2-3 | 1-2 | 0-1 | 4-5 | 1-3 | 3-4 | 15-5 | 20-15 | 4-15 | 21-5 | 21-20 | 3-21 | 
applying recursive analysis ...
==================
analyzing node 21 ...
target of backedge  ... False
branching ... True
couldn't find simple structure.
found knot-node: 5
==================
analyzing node 15 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [15]
found nothing, block is singular.
==================
analyzing node 5 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [5]
found nothing, block is singular.
==================
analyzing node 4 ...
target of backedge  ... False
branching ... True
couldn't find simple structure.
found knot-node: 5
==================
analyzing node 3 ...
target of backedge  ... False
branching ... True
couldn't find simple structure.
found knot-node: 5
reducing condition: [3, 4, 21]
replaced edges: 4-5 4-15 21-5 21-20
==================
analyzing node 2 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [2]
found nothing, block is singular.
==================
analyzing node 1 ...
target of backedge  ... False
branching ... True
found simple structure.
if-then: [1, 2]
reduction successful.
current nodeset: | 0 | 5 | 15 | 20 | 22 | 23 | 
current edgeset: | 22-15 | 22-20 | 23-22 | 15-5 | 22-5 | 20-15 | 0-23 | 
applying recursive analysis ...
==================
analyzing node 23 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [22, 23]
appendable to 22 ... False
reduction successful.
current nodeset: | 0 | 24 | 20 | 5 | 15 | 
current edgeset: | 24-15 | 24-20 | 15-5 | 24-5 | 20-15 | 0-24 | 
applying recursive analysis ...
==================
analyzing node 24 ...
target of backedge  ... False
branching ... False
==================
analyzing node 0 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [0, 24]
appendable to 24 ... True
appending to existing block ... done: 24
reduction successful.
current nodeset: | 24 | 20 | 5 | 15 | 
current edgeset: | 24-15 | 15-5 | 24-20 | 20-15 | 24-5 | 
applying recursive analysis ...
==================
analyzing node 24 ...
target of backedge  ... False
branching ... False
==================RESULTS==================
Graph starting at node 24
id: 24 type: block starts at 0:
    |-- nodes:
    |   id: 0 type: low-level
    |   +-----------------------+
    |   |TlsCallback_0 proc near|
    |   |var_18= dword ptr -18h |
    |   |var_14= dword ptr -14h |
    |   |var_10= dword ptr -10h |
    |   |arg_0= dword ptr  8    |
    |   |arg_4= dword ptr  0Ch  |
    |   |arg_8= dword ptr  10h  |
    |   |push ebx               |
    |   |sub esp, 18h           |
    |   +-----------------------+
    |   
    |   id: 23 type: if-then starts at 1:
    |       then:2 condition:1 
    |       |-- nodes:
    |       |   id: 1 type: low-level
    |       |   +------------------------+
    |       |   |cmp dword_408014, 2     |
    |       |   |mov eax, [esp+18h+arg_4]|
    |       |   |jz short loc_4015EB     |
    |       |   +------------------------+
    |       |   
    |       |   id: 2 type: low-level
    |       |   +-------------------+
    |       |   |mov dword_408014, 2|
    |       |   +-------------------+
    |       |   
    |       |-- edges:
    |       |       1-2
    |       
    |   id: 22 type: condition starts at 3:
    |       |-- nodes:
    |       |   id: 3 type: low-level
    |       |   +-------------------+
    |       |   |loc_4015EB:        |
    |       |   |cmp eax, 2         |
    |       |   |jz short loc_401601|
    |       |   +-------------------+
    |       |   
    |       |   id: 4 type: low-level
    |       |   +-------------------+
    |       |   |cmp eax, 1         |
    |       |   |jz short loc_401630|
    |       |   +-------------------+
    |       |   
    |       |   id: 21 type: block starts at 6:
    |       |       |-- nodes:
    |       |       |   id: 6 type: low-level
    |       |       |   +--------------------------+
    |       |       |   |loc_401601:               |
    |       |       |   |mov ebx, offset unk_40C030|
    |       |       |   +--------------------------+
    |       |       |   
    |       |       |   id: 7 type: low-level
    |       |       |   +--------------------------+
    |       |       |   |cmp ebx, offset unk_40C030|
    |       |       |   |jz short loc_4015F5       |
    |       |       |   +--------------------------+
    |       |       |   
    |       |       |-- edges:
    |       |       |       6-7
    |       |       
    |       |-- edges:
    |       |       3-4
    |       |       3-21
    |       |   
    |       |-- outer edges:
    |       |       4-5
    |       |       4-15
    |       |       21-5
    |       |       21-20
    |       
    |-- edges:
    |       23-22
    |       0-23
    
id: 20 type: block starts at 8:
    |-- nodes:
    |   id: 8 type: low-level
    |   +------+
    |   |db 66h|
    |   |nop   |
    |   +------+
    |   
    |   id: 19 type: do-loop starts at 17:
    |       body:17 condition:13 
    |       |-- nodes:
    |       |   id: 17 type: block starts at 9:
    |       |       |-- nodes:
    |       |       |   id: 9 type: low-level
    |       |       |   +--------------+
    |       |       |   |loc_401610:   |
    |       |       |   |mov eax, [ebx]|
    |       |       |   +--------------+
    |       |       |   
    |       |       |   id: 18 type: if-then starts at 10:
    |       |       |       then:11 condition:10 
    |       |       |       |-- nodes:
    |       |       |       |   id: 10 type: low-level
    |       |       |       |   +-------------------+
    |       |       |       |   |test eax, eax      |
    |       |       |       |   |jz short loc_401618|
    |       |       |       |   +-------------------+
    |       |       |       |   
    |       |       |       |   id: 11 type: low-level
    |       |       |       |   +--------+
    |       |       |       |   |call eax|
    |       |       |       |   +--------+
    |       |       |       |   
    |       |       |       |-- edges:
    |       |       |       |       10-11
    |       |       |       
    |       |       |   id: 12 type: low-level
    |       |       |   +-----------+
    |       |       |   |loc_401618:|
    |       |       |   |add ebx, 4 |
    |       |       |   +-----------+
    |       |       |   
    |       |       |   id: 13 type: low-level
    |       |       |   +--------------------------+
    |       |       |   |cmp ebx, offset unk_40C030|
    |       |       |   |jnz short loc_401610      |
    |       |       |   +--------------------------+
    |       |       |   
    |       |       |-- edges:
    |       |       |       12-13
    |       |       |       18-12
    |       |       |       9-18
    |       |       
    |       |-- edges:
    |       |       17-17
    |       
    |   id: 14 type: low-level
    |   +------------+
    |   |add esp, 18h|
    |   |mov eax, 1  |
    |   |pop ebx     |
    |   |retn 0Ch    |
    |   |align 10h   |
    |   +------------+
    |   
    |-- edges:
    |       19-14
    |       8-19
    
id: 5 type: low-level
+------------+
|loc_4015F5: |
|add esp, 18h|
|mov eax, 1  |
|pop ebx     |
|retn 0Ch    |
+------------+

id: 15 type: low-level
+-------------------------+
|loc_401630:              |
|mov eax, [esp+18h+arg_8] |
|mov [esp+18h+var_14], 1  |
|mov [esp+18h+var_10], eax|
|mov eax, [esp+18h+arg_0] |
|mov [esp+18h+var_18], eax|
|call sub_402640          |
|jmp short loc_4015F5     |
+-------------------------+

