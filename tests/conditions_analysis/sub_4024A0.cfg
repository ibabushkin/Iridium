
=== 0 0 13 ===
sub_4024A0 proc near
var_1C= dword ptr -1Ch
push ebp
push edi
push esi
push ebx
sub esp, 1C
mov [esp+1Ch+var_1C], offset unk_40A3A4
call ds:EnterCriticalSection
mov ebx, ds:dword_40A3BC
mov ebp, ds:TlsGetValue
mov edi, ds:GetLastError
sub esp, 4


=== 1 13 15 ===
test ebx, ebx
jz short loc_4024F5


=== 2 15 16 ===
lea esi, [esi+0]


=== 3 16 23 ===
loc_4024D0:
mov eax, [ebx]
mov [esp+1Ch+var_1C], eax
call eb
sub esp, 4
mov esi, eax
call ed


=== 4 23 25 ===
test eax, eax
jnz short loc_4024EE


=== 5 25 27 ===
test esi, esi
jz short loc_4024EE


=== 6 27 30 ===
mov eax, [ebx+4]
mov [esp+1Ch+var_1C], esi
call eax


=== 7 30 32 ===
loc_4024EE:
mov ebx, [ebx+8]


=== 8 32 34 ===
test ebx, ebx
jnz short loc_4024D0


=== 9 34 45 ===
loc_4024F5:
mov [esp+1Ch+var_1C], offset unk_40A3A4
call ds:LeaveCriticalSection
sub esp, 4
add esp, 1Ch
pop ebx
pop esi
pop edi
pop ebp
retn 
sub_4024A0 endp

0-1
1-9
1-2
2-3
3-4
4-7
4-5
5-7
5-6
6-7
7-8
8-3
8-9
==================
Analyzer is reducing graph ...
Postorder of dfs-tree: [8, 7, 6, 5, 4, 3, 2, 9, 1, 0]
==================
analyzing node 8 ...
target of backedge  ... False
branching ... True
couldn't find simple structure.
found knot-node: 9
block: [9]
found nothing, block is singular.
==================
analyzing node 7 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [8, 7]
appendable to 8 ... False
reduction successful.
current nodeset: | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 9 | 10 | 
current edgeset: | 1-9 | 2-3 | 3-4 | 0-1 | 5-10 | 6-10 | 1-2 | 10-9 | 4-10 | 5-6 | 10-3 | 4-5 | 
applying recursive analysis ...
==================
analyzing node 10 ...
target of backedge  ... False
branching ... True
couldn't find simple structure.
found knot-node: 9
==================
analyzing node 6 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [6]
found nothing, block is singular.
==================
analyzing node 5 ...
target of backedge  ... False
branching ... True
found simple structure.
if-then: [5, 6]
reduction successful.
current nodeset: | 0 | 1 | 2 | 3 | 4 | 9 | 10 | 11 | 
current edgeset: | 1-9 | 2-3 | 1-2 | 0-1 | 3-4 | 10-9 | 4-10 | 4-11 | 10-3 | 11-10 | 
applying recursive analysis ...
==================
analyzing node 11 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [11]
found nothing, block is singular.
==================
analyzing node 4 ...
target of backedge  ... False
branching ... True
found simple structure.
if-then: [11, 4]
reduction successful.
current nodeset: | 0 | 1 | 2 | 3 | 9 | 10 | 12 | 
current edgeset: | 1-9 | 2-3 | 12-10 | 0-1 | 3-12 | 1-2 | 10-9 | 10-3 | 
applying recursive analysis ...
==================
analyzing node 12 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [10, 12]
appendable to 10 ... True
appending to existing block ... done: 10
reduction successful.
current nodeset: | 0 | 1 | 2 | 3 | 9 | 10 | 
current edgeset: | 1-9 | 2-3 | 0-1 | 1-2 | 10-9 | 3-10 | 10-3 | 
applying recursive analysis ...
==================
analyzing node 10 ...
target of backedge  ... False
branching ... True
couldn't find simple structure.
found knot-node: 9
block: [12]
found nothing, block is singular.
==================
analyzing node 3 ...
target of backedge  ... 10
branching ... False
loop... False
found simple structure.
block: [10, 3]
appendable to 10 ... True
appending to existing block ... done: 10
reduction successful.
current nodeset: | 0 | 1 | 2 | 10 | 9 | 
current edgeset: | 1-9 | 10-10 | 0-1 | 1-2 | 10-9 | 2-10 | 
applying recursive analysis ...
==================
analyzing node 10 ...
target of backedge  ... 10
branching ... True
loop... False
found simple structure.
do-loop: 10
reduction successful.
current nodeset: | 0 | 1 | 2 | 13 | 9 | 
current edgeset: | 1-9 | 13-9 | 1-2 | 0-1 | 2-13 | 
applying recursive analysis ...
==================
analyzing node 13 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [13]
found nothing, block is singular.
==================
analyzing node 2 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [2, 13]
appendable to 13 ... False
reduction successful.
current nodeset: | 0 | 1 | 14 | 9 | 
current edgeset: | 1-9 | 1-14 | 14-9 | 0-1 | 
applying recursive analysis ...
==================
analyzing node 14 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [14]
found nothing, block is singular.
==================
analyzing node 9 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [9]
found nothing, block is singular.
==================
analyzing node 1 ...
target of backedge  ... False
branching ... True
found simple structure.
if-then: [1, 14]
reduction successful.
current nodeset: | 0 | 9 | 15 | 
current edgeset: | 15-9 | 0-15 | 
applying recursive analysis ...
==================
analyzing node 15 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [9, 15]
appendable to 9 ... False
reduction successful.
current nodeset: | 0 | 16 | 
current edgeset: | 0-16 | 
applying recursive analysis ...
==================
analyzing node 16 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [16]
found nothing, block is singular.
==================
analyzing node 0 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [0, 16]
appendable to 16 ... True
appending to existing block ... done: 16
reduction successful.
current nodeset: | 16 | 
applying recursive analysis ...
==================
analyzing node 16 ...
target of backedge  ... False
branching ... False
found simple structure.
block: [16]
found nothing, block is singular.
==================RESULTS==================
Graph starting at node 16
id: 16 type: block starts at 0:
    |-- nodes:
    |   id: 0 type: low-level
    |   +---------------------------------------+
    |   |sub_4024A0 proc near                   |
    |   |var_1C= dword ptr -1Ch                 |
    |   |push ebp                               |
    |   |push edi                               |
    |   |push esi                               |
    |   |push ebx                               |
    |   |sub esp, 1C                            |
    |   |mov [esp+1Ch+var_1C], offset unk_40A3A4|
    |   |call ds:EnterCriticalSection           |
    |   |mov ebx, ds:dword_40A3BC               |
    |   |mov ebp, ds:TlsGetValue                |
    |   |mov edi, ds:GetLastError               |
    |   |sub esp, 4                             |
    |   +---------------------------------------+
    |   
    |   id: 15 type: if-then starts at 1:
    |       then:14 condition:1 
    |       |-- nodes:
    |       |   id: 1 type: low-level
    |       |   +-------------------+
    |       |   |test ebx, ebx      |
    |       |   |jz short loc_4024F5|
    |       |   +-------------------+
    |       |   
    |       |   id: 14 type: block starts at 2:
    |       |       |-- nodes:
    |       |       |   id: 2 type: low-level
    |       |       |   +----------------+
    |       |       |   |lea esi, [esi+0]|
    |       |       |   +----------------+
    |       |       |   
    |       |       |   id: 13 type: do-loop starts at 10:
    |       |       |       body:10 condition:8 
    |       |       |       |-- nodes:
    |       |       |       |   id: 10 type: block starts at 3:
    |       |       |       |       |-- nodes:
    |       |       |       |       |   id: 3 type: low-level
    |       |       |       |       |   +-------------------------+
    |       |       |       |       |   |loc_4024D0:              |
    |       |       |       |       |   |mov eax, [ebx]           |
    |       |       |       |       |   |mov [esp+1Ch+var_1C], eax|
    |       |       |       |       |   |call eb                  |
    |       |       |       |       |   |sub esp, 4               |
    |       |       |       |       |   |mov esi, eax             |
    |       |       |       |       |   |call ed                  |
    |       |       |       |       |   +-------------------------+
    |       |       |       |       |   
    |       |       |       |       |   id: 12 type: if-then starts at 4:
    |       |       |       |       |       then:11 condition:4 
    |       |       |       |       |       |-- nodes:
    |       |       |       |       |       |   id: 4 type: low-level
    |       |       |       |       |       |   +--------------------+
    |       |       |       |       |       |   |test eax, eax       |
    |       |       |       |       |       |   |jnz short loc_4024EE|
    |       |       |       |       |       |   +--------------------+
    |       |       |       |       |       |   
    |       |       |       |       |       |   id: 11 type: if-then starts at 5:
    |       |       |       |       |       |       then:6 condition:5 
    |       |       |       |       |       |       |-- nodes:
    |       |       |       |       |       |       |   id: 5 type: low-level
    |       |       |       |       |       |       |   +-------------------+
    |       |       |       |       |       |       |   |test esi, esi      |
    |       |       |       |       |       |       |   |jz short loc_4024EE|
    |       |       |       |       |       |       |   +-------------------+
    |       |       |       |       |       |       |   
    |       |       |       |       |       |       |   id: 6 type: low-level
    |       |       |       |       |       |       |   +-------------------------+
    |       |       |       |       |       |       |   |mov eax, [ebx+4]         |
    |       |       |       |       |       |       |   |mov [esp+1Ch+var_1C], esi|
    |       |       |       |       |       |       |   |call eax                 |
    |       |       |       |       |       |       |   +-------------------------+
    |       |       |       |       |       |       |   
    |       |       |       |       |       |       |-- edges:
    |       |       |       |       |       |       |       5-6
    |       |       |       |       |       |       
    |       |       |       |       |       |-- edges:
    |       |       |       |       |       |       4-11
    |       |       |       |       |       
    |       |       |       |       |   id: 7 type: low-level
    |       |       |       |       |   +----------------+
    |       |       |       |       |   |loc_4024EE:     |
    |       |       |       |       |   |mov ebx, [ebx+8]|
    |       |       |       |       |   +----------------+
    |       |       |       |       |   
    |       |       |       |       |   id: 8 type: low-level
    |       |       |       |       |   +--------------------+
    |       |       |       |       |   |test ebx, ebx       |
    |       |       |       |       |   |jnz short loc_4024D0|
    |       |       |       |       |   +--------------------+
    |       |       |       |       |   
    |       |       |       |       |-- edges:
    |       |       |       |       |       7-8
    |       |       |       |       |       12-7
    |       |       |       |       |       3-12
    |       |       |       |       
    |       |       |       |-- edges:
    |       |       |       |       10-10
    |       |       |       
    |       |       |-- edges:
    |       |       |       2-13
    |       |       
    |       |-- edges:
    |       |       1-14
    |       
    |   id: 9 type: low-level
    |   +---------------------------------------+
    |   |loc_4024F5:                            |
    |   |mov [esp+1Ch+var_1C], offset unk_40A3A4|
    |   |call ds:LeaveCriticalSection           |
    |   |sub esp, 4                             |
    |   |add esp, 1Ch                           |
    |   |pop ebx                                |
    |   |pop esi                                |
    |   |pop edi                                |
    |   |pop ebp                                |
    |   |retn                                   |
    |   |sub_4024A0 endp                        |
    |   +---------------------------------------+
    |   
    |-- edges:
    |       15-9
    |       0-15
    
